/*! cms 2018-03-26 */
!function(a,b){"use strict";a.Instagram=function(a){Object.defineProperty(this,"API_URL",{enumerable:!1,configurable:!1,writable:!1,value:"https://api.instagram.com/v1"}),Object.defineProperty(this,"ENDPOINTS",{enumerable:!1,configurable:!1,writable:!1,value:{tag:"tags/{tagName}",tagRecent:"tags/{tagName}/media/recent",user:"users/self/media/recent"}});var b={hashtag:"",clientID:"",accessToken:"",maxPhotos:14,photoTmplElm:$("#instagram-photo-tmpl"),galleryElmSel:"#instagram-gallery",initSlick:!0};this.options=$.extend(!0,b,a),this.loadedPhotos=[],this.nextMaxTagId,this.loadNext=!0},a.Instagram.prototype.init=function(){var a=this,b=this.options;$(b.galleryElmSel).empty(),a.initPhotoSwipe(".instagram__link"),this.initSlick()},a.Instagram.prototype.buildRequestURL=function(a){var b=this.options,c=this.API_URL,d=this.ENDPOINTS;a||(a="user");var e=c;return e+="/"+d[a].replace("{tagName}",b.hashtag)},a.Instagram.prototype.getData=function(a,b){var c=this,d=this.options,e=this.buildRequestURL(a);e&&c.loadNext&&$.ajax({url:e,dataType:"jsonp",type:"GET",data:{access_token:d.accessToken,count:d.maxPhotos,max_tag_id:c.nextMaxTagId}}).done(function(a){"function"==typeof b&&b.call(null,a)})},a.Instagram.prototype.loadPhotos=function(){var a=this,b=this.options;this.getData("user",function(c){var d=c.data,e=c.pagination.next_max_tag_id;if(a.nextMaxTagId=e,e||(a.loadNext=!1),d.length){var f=a.loadedPhotos.length,g=_.template(b.photoTmplElm.html());_.each(d,function(c){var d=c.images,e=c.caption,h=c.likes,i=d?d.standard_resolution:"",j=d?d.low_resolution:"";if(i.url&&g){var k={src:i.url,msrc:j.url,title:e?e.text:"",likes:h.count,w:i.width,h:i.height,index:f};$(b.galleryElmSel).slick("slickAdd",g(k)),a.loadedPhotos.push(k),f++}})}})},a.Instagram.prototype.initPhotoSwipe=function(a){var b=this,c=(this.options,{index:0,shareEl:!1,preload:[1,3],history:!1,bgOpacity:.9});$(document).on("click",a,function(a){a.preventDefault();var d=$(this),e=d.data("index");c.index=e,new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,b.loadedPhotos,c).init()})},a.Instagram.prototype.initSlick=function(){var a=this,b=this.options;!0===b.initSlick&&$(b.galleryElmSel).on("init",function(b,c){a.loadPhotos()}).slick({mobileFirst:!0,adaptiveHeight:!1,autoplay:!1,autoplaySpeed:5e3,dots:!1,infinite:!1,speed:250,slidesToShow:3,slidesToScroll:3,prevArrow:"",nextArrow:"",responsive:[{breakpoint:320,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:767,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1199,settings:{slidesToShow:6,slidesToScroll:6}}]}).on("afterChange",function(b,c,d,e){2*d>=a.loadedPhotos.length&&a.loadPhotos()})}}(window,document),function(a){function b(){var a=$(".cover-video"),b=a.data("id"),c="ytplayer",d=$("#"+c),e=d.data("id");if(1==a.length&&b||1==d.length&&e){var f=document.createElement("script");f.src="https://www.youtube.com/iframe_api?callback=onYouTubeIframeAPIReady",$("head").append(f)}}a.App=function(){this.config={serviceUrl:"/requests/service",loadedGalleries:{}}},a.App.prototype.init=function(){this.config=$.extend(!0,this.config,jsVars),this.toggleNav(".nav-toggle"),this.toggleSubNav(".toggle-sub-nav"),this.initHeroSlider("#slider"),this.initHeroScroll(".hero__scroll"),this.initReviewsCarousel(".reviews-carousel"),this.initFeaturedCarousel(".featured-carousel"),this.initCaseStudyCarousel(".case-study-carousel"),this.initPartnerLogosCarousel(".partner-logos"),this.initGalleryCarousel(".gallery__carousel"),this.initPhotoswipe(".gallery__carousel a"),this.initShuffle("#shuffle"),this.initGallery("[data-launch-gallery]"),this.initVideoPopup("[data-toggle-popup]"),this.initMap(),this.initNewsletterSignup("#news-signup-form"),this.matchElmHeight(".tour-item"),$(window).on("resize",function(){app.matchElmHeight(".tour-item"),app.setHeroVideoDimensions()}).trigger("resize"),$(".scroll-trigger").on("click",function(a){a.preventDefault();var b=$(window).height();scrollPoint=$(window).scrollTop(),scrollPoint<b&&$("html, body").delay(200).animate({scrollTop:b},{duration:350})}),$(".general-page .primary__header").addClass("section-white"),$(window).width()<=991&&$(".home-page .primary__header").addClass("section-white"),$(window).scroll(function(){$(window).width()<991?$(".home-page .primary__header").addClass("section-white"):$(this).scrollTop()>100?$(".home-page .primary__header").addClass("section-white"):$(".home-page .primary__header").removeClass("section-white")});var a=$(".package-modal"),b=$(".package-modal-wrapper");$(".package-modal__close-button").on("click",function(){a.hide(),b.hide()}),$(".package-view-detail__button").on("click",function(c){b.show();var d=$(c.target).data("packageId");a.hide(),$(".package-modal[data-package-id="+d+"]").show(),$(window).scrollTop(0)}),$(".faq-item__question").on("click",function(a){$(this).next().toggle()})},a.App.prototype.setHeroVideoDimensions=function(){var a=$(".video__wrapper iframe");if(a.length){var b=$(window).height(),c=$(window).width(),d=1.77*b;d<c?(d=c,newIframeHeight=.565*c):newIframeHeight=b;a.css({height:newIframeHeight,width:d})}},a.App.prototype.initHeroSlider=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:600,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:this.config.globals.slideshowSpeed,fade:!0,cssEase:"linear",arrows:!0,prevArrow:'<div class="slider__nav slider__nav--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="slider__nav slider__nav--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1})},a.App.prototype.initReviewsCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:600,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:6e3,fade:!0,cssEase:"linear",arrows:!0,prevArrow:'<div class="review__carousel__nav review__carousel__nav--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="review__carousel__nav review__carousel__nav--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1})},a.App.prototype.initFeaturedCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!1,speed:300,slidesToShow:3,slidesToScroll:3,cssEase:"linear",arrows:!0,prevArrow:'<div class="featured__carousel__nav featured__carousel__nav--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="featured__carousel__nav featured__carousel__nav--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1,responsive:[{breakpoint:320,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:3}}]})},a.App.prototype.initCaseStudyCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!0,infinite:!1,speed:300,slidesToShow:1,slidesToScroll:1,cssEase:"linear",arrows:!0,mobileFirst:!0,adaptiveHeight:!1})},a.App.prototype.initPartnerLogosCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:300,slidesToShow:6,slidesToScroll:3,cssEase:"linear",arrows:!0,prevArrow:'<div class="partner-carousel-nav-button partner-carousel-nav-button--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="partner-carousel-nav-button partner-carousel-nav-button--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1,responsive:[{breakpoint:319,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1200,settings:{slidesToShow:6,slidesToScroll:3}}]})},a.App.prototype.initHeroScroll=function(a){$(a).on("click",function(a){a.preventDefault(),topHeight=$(window).width()<=991?50:220,$("html, body").delay(100).animate({scrollTop:$("#main").offset().top-topHeight},400)})},a.App.prototype.initMap=function(){if($("#map-canvas").length){var a=app.getConfigItem("latitude"),b=app.getConfigItem("longitude"),c=app.getConfigItem("zoomLevel"),d=app.getConfigItem("address");if(a&&b){var e,f=$(window).width(),g=!1,h="/graphics/map-marker.png";f>992&&(g=!0);var i={zoom:parseInt(c),center:new google.maps.LatLng(a,b),scrollwheel:!1,zoomControl:!0,draggable:g,mapTypeId:google.maps.MapTypeId.ROAD};e=new google.maps.Map(document.getElementById("map-canvas"),i),marker=new google.maps.Marker({position:new google.maps.LatLng(a,b),map:e,icon:h});var j=new google.maps.InfoWindow({content:d});marker.addListener("click",function(){j.open(e,marker)})}}},a.App.prototype.initGalleryCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:300,slidesToShow:3,slidesToScroll:1,prevArrow:'<div class="gallery__carousel__prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="gallery__carousel__next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1,responsive:[{breakpoint:320,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:3,slidesToScroll:1}}]})},a.App.prototype.initPhotoswipe=function(a){var b=$(a);if(b.length){var c=app.getConfigItem("galleryImages"),d={index:0,shareEl:!1,preload:[1,2],history:!1,bgOpacity:.8};$.each(c,function(a,b){c[a].src=b.full_path}),b.on("click",function(a){a.preventDefault(),d.index=$(this).data("key"),new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,c,d).init()})}},a.App.prototype.initShuffle=function(a){var b=$(a),c=this;b.length&&(b.shuffle({group:"all",itemSelector:"figure",speed:450}),$(".shuffle-trigger").on("click",function(a){a.preventDefault(),b.shuffle("shuffle",$(this).attr("data-group")),$(".shuffle-trigger").removeClass("active"),$(this).addClass("active")}),b.on("done.shuffle",function(){c.initPhotoswipeShuffle(a+" .gallery__item.ps-item")}))},a.App.prototype.initPhotoswipeShuffle=function(a){var b=$(a);if(b.length){var c=app.getConfigItem("templates").psGallery;0==$(".pswp").length&&$("body").append(c);var d={index:0,shareEl:!1,preload:[1,2],history:!1,bgOpacity:.8};b.on("click",function(b){b.preventDefault();var c=$(this),e=(c.data("gp"),$(a).siblings(".filtered")),f=c.data("fpath"),g=[];if(e.length&&e.each(function(a,b){var c=$(b),d=c.attr("data-fpath"),e=c.attr("title"),f=c.data("size").split("x");g.push({src:d,w:f[0],h:f[1],title:e})}),g.length){var h=$.map(g,function(a,b){return a.src});d.index=h.indexOf(f);new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,g,d).init()}})}},a.App.prototype.initGallery=function(a){function b(a,b,c){if(!a)return!1;app.config.loadedGalleries.hasOwnProperty(a)?"function"==typeof c&&c.call():$.get(app.getConfigItem("serviceUrl"),"action=fetch-gallery&key="+a,function(b){app.config.loadedGalleries[a]=b,"function"==typeof c&&c.call()},"json")}function c(a,b){if(!a)return!1;var c=app.config.loadedGalleries[a];if(c.length>0){b&&(e.index=b);new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,c,e).init()}}var d=app.getConfigItem("templates").galleryModal;0==$(".pswp").length&&$("body").append(d);var e={index:0,shareEl:!1,preload:[1,3],history:!1,bgOpacity:.9};$("body").on("click",a,function(a){a.preventDefault();var d=$(this),e=d.data("launch-gallery"),f=d.data("index");d.hasClass("launch-gallery")&&b(e,f,function(){c(e,f)})})},a.App.prototype.initVideoPopup=function(a){var b=$(a);b.length&&(b.on("click",function(a){a.preventDefault();var b=$(this),c=$(b.data("toggle-popup"));c.toggleClass("open"),$("body").addClass("no-scroll");var d=c.find("iframe");d.length&&d.attr("src",d.data("src"))}),$("body").on("click",".popup .close",function(a){a.preventDefault();var b=$(this),c=$(b.attr("href"));c.toggleClass("open"),$("body").removeClass("no-scroll");var d=c.find("iframe");d.length&&d.removeAttr("src")}))},a.App.prototype.getVar=function(a,b){if(b.hasOwnProperty(a))return b[a];for(var c in b)if(b[c].hasOwnProperty(a))return b[c][a];return!1},a.App.prototype.getConfigItem=function(a){return this.getVar(a,this.config)},a.App.prototype.toggleNav=function(a){var b=$(a);b.length&&b.on("click",function(a){a.preventDefault();var b=($(this),$("header nav"));b.length&&(b.toggle(),$(".nav-toggle").toggleClass("active"),$("body").toggleClass("no-scroll"))})},a.App.prototype.toggleSubNav=function(a){var b=$(a);b.length&&b.on("click",function(a){a.preventDefault();var b=$(this),c=b.parents(".has-sub").find("ul");c.length&&(c.toggleClass("active"),b.toggleClass("active"))})},a.App.prototype.matchElmHeight=function(a){var b="string"==typeof a?$(a):a;if(b){b.css("height","auto");var c=0;b.each(function(a,b){var d=$(b),e=d.height();e>c&&(c=e)}),b.css("height",c)}},a.App.prototype.initNewsletterSignup=function(a){var b=$(a);if(b.length){var c=b.find("#newsletter-submit");c.length&&c.on("click",function(a){a.preventDefault();var c=$.trim(b.find("#signup-email").val()),d="",e="msg--error",f=b.find(".msg");if(c){/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(c)?$.post(app.getConfigItem("serviceUrl"),"action=sign-up&email="+c,function(a){return a.msg&&f.removeAttr("class").addClass("msg "+a.type).html(a.msg),a.isValid&&setTimeout(function(){f.removeClass(a.type).html(""),b.find("#full-name").val(""),b.find("#signup-email").val("")},5e3),!1},"json"):d="Invalid email address provided."}else d="Your email address is required.";d&&f.removeAttr("class").addClass("msg "+e).html(d)})}},a.onYouTubeIframeAPIReady=function(){var a=$(".cover-video").get(0);if(a){var b,c,d=$(".video__wrapper"),e=a.getAttribute("data-id"),f=d.width(),g=d.height();d.css("overflow","hidden");new YT.Player(a,{videoId:e,width:f,height:g,playerVars:{start:0,autoplay:!0,controls:!1,showinfo:!1,modestbranding:!0,loop:!0,fs:!1,cc_load_policy:!0,iv_load_policy:3,autohide:!1,playlist:e,rel:0},events:{onReady:function(a){a.target.mute(),b=1.77*g,b<f?(b=f,c=.565*f):c=g,$(".cover-video").css({height:c,width:b})}}})}var h="ytplayer",i=$("#"+h),j=i.data("id"),k=$(".play-video-btn");if(console.log("second video loading up"),i&&j){var l=parseInt(i.data("autoplay"));new YT.Player(h,{videoId:j,playerVars:{autoplay:l,controls:!1,rel:!1,showinfo:!1,modestbranding:!1,loop:!1,fs:!1,cc_load_policy:!0,iv_load_policy:3,autohide:!1},events:{onReady:function(a){1==l&&(a.target.mute(),a.target.playVideo()),k.on("click",function(){a.target.playVideo(),k.hide()})},onStateChange:function(a){a.data==YT.PlayerState.ENDED&&($(".homepage-youtube__background").fadeIn(),k.fadeIn()),a.data==YT.PlayerState.PLAYING&&$(".homepage-youtube__background").fadeOut()}}})}},b(),new WOW({animateClass:"animated",offset:100,mobile:!1,callback:function(a){}}).init()}(window);var app=new App;