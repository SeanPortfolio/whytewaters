/*! cms 2018-02-22 */
!function(a,b){"use strict";a.Instagram=function(a){Object.defineProperty(this,"API_URL",{enumerable:!1,configurable:!1,writable:!1,value:"https://api.instagram.com/v1"}),Object.defineProperty(this,"ENDPOINTS",{enumerable:!1,configurable:!1,writable:!1,value:{tag:"tags/{tagName}",tagRecent:"tags/{tagName}/media/recent",user:"users/self/media/recent"}});var b={hashtag:"",clientID:"",accessToken:"",maxPhotos:14,photoTmplElm:$("#instagram-photo-tmpl"),galleryElmSel:"#instagram-gallery",initSlick:!0};this.options=$.extend(!0,b,a),this.loadedPhotos=[],this.nextMaxTagId,this.loadNext=!0},a.Instagram.prototype.init=function(){var a=this,b=this.options;$(b.galleryElmSel).empty(),a.initPhotoSwipe(".instagram__link"),this.initSlick()},a.Instagram.prototype.buildRequestURL=function(a){var b=this.options,c=this.API_URL,d=this.ENDPOINTS;a||(a="user");var e=c;return e+="/"+d[a].replace("{tagName}",b.hashtag)},a.Instagram.prototype.getData=function(a,b){var c=this,d=this.options,e=this.buildRequestURL(a);e&&c.loadNext&&$.ajax({url:e,dataType:"jsonp",type:"GET",data:{access_token:d.accessToken,count:d.maxPhotos,max_tag_id:c.nextMaxTagId}}).done(function(a){"function"==typeof b&&b.call(null,a)})},a.Instagram.prototype.loadPhotos=function(){var a=this,b=this.options;this.getData("user",function(c){var d=c.data,e=c.pagination.next_max_tag_id;if(a.nextMaxTagId=e,e||(a.loadNext=!1),d.length){var f=a.loadedPhotos.length,g=_.template(b.photoTmplElm.html());_.each(d,function(c){var d=c.images,e=c.caption,h=c.likes,i=d?d.standard_resolution:"",j=d?d.low_resolution:"";if(i.url&&g){var k={src:i.url,msrc:j.url,title:e?e.text:"",likes:h.count,w:i.width,h:i.height,index:f};$(b.galleryElmSel).slick("slickAdd",g(k)),a.loadedPhotos.push(k),f++}})}})},a.Instagram.prototype.initPhotoSwipe=function(a){var b=this,c=(this.options,{index:0,shareEl:!1,preload:[1,3],history:!1,bgOpacity:.9});$(document).on("click",a,function(a){a.preventDefault();var d=$(this),e=d.data("index");c.index=e,new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,b.loadedPhotos,c).init()})},a.Instagram.prototype.initSlick=function(){var a=this,b=this.options;!0===b.initSlick&&$(b.galleryElmSel).on("init",function(b,c){a.loadPhotos()}).slick({mobileFirst:!0,adaptiveHeight:!1,autoplay:!1,autoplaySpeed:5e3,dots:!1,infinite:!1,speed:250,slidesToShow:3,slidesToScroll:3,prevArrow:"",nextArrow:"",responsive:[{breakpoint:320,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:767,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1199,settings:{slidesToShow:6,slidesToScroll:6}}]}).on("afterChange",function(b,c,d,e){2*d>=a.loadedPhotos.length&&a.loadPhotos()})}}(window,document),function(a,b){"use strict";a.Booking=function(a){var b={bookingFormElm:"#form-wizard",bookingCalendarElm:"#datepicker",tourSessionsElm:".tour-sessions",tourItineraryElm:".tour-itinerary",selSessionElm:".sel-tour-session",btnBookNowStep2:".tour-booking-btn",btnConfirmBooking:"#confirm-booking",priceTypeTmpl:"#session-price-type-tmpl",actionUrl:"/ajax/booking.php"};this.options=$.extend(!0,b,a)},a.Booking.prototype.init=function(){this.options;this.initFormWizard(),this.initBookingCalendar(),this.getTourSessions(),this.selectSession(),this.changePaxQty(),this.applyPromoCode(),this.setItinerary(),this.confirmBooking()},a.Booking.prototype.getTourSessions=function(){var a=this.options;if($(a.tourSessionsElm).length){var b=$(a.bookingFormElm).data("token"),c=$(a.bookingCalendarElm).datepicker("getDate"),d=$.datepicker.formatDate("dd/mm/yy",new Date(c)),e=$(a.tourSessionsElm).find(".tour-sessions-body"),f=_.template($("#tour-sessions-tmpl").html());$.post(a.actionUrl,"action=fetch-tour-sessions&tour="+b+"&date="+d,function(a){e.empty();var b=f(a);e.append(b)},"json")}},a.Booking.prototype.selectSession=function(){var a=this.options;$(a.tourSessionsElm).on("click",a.selSessionElm,function(b){b.preventDefault(),$(a.selSessionElm).removeClass("active");var c=$(this),d=c.parents(".item__option"),e=d.data("token");c.addClass("active");var f=$(a.bookingFormElm).data("token"),g=$(a.bookingCalendarElm).datepicker("getDate"),h=$.datepicker.formatDate("dd/mm/yy",new Date(g));$.post(a.actionUrl,"action=fetch-session-details&tour="+f+"&date="+h+"&session="+e,function(b){if(b.isValid){var c=b.session,d=_.template($(a.priceTypeTmpl).html()),e=d(c);$(".price-type-wrapper").html(e),$(".sel-datetime").text(c.date+" "+c.time),$(".session-spaces").text(c.remaining).data("originalRemaining",c.remaining)}},"json"),$(a.bookingFormElm).steps("next")})},a.Booking.prototype.changePaxQty=function(){var a=this.options;$(a.tourItineraryElm).on("change",".pax-selector",function(b){var c=($(this),$(".session-spaces")),d=$(".session-spaces").data("originalRemaining"),e=$(".pax-selector"),f=(e.not(this),0);$.each(e,function(a,b){var c=$(b);f+=parseInt(c.val())});var g=d-f;c.text(g),$.each(e,function(a,b){for(var c="",d=$(b),e=d.val(),f=e>g?e:g,h=0;h<=f;h++){c+='<option value="'+h+'" '+(h==e?'selected="selected"':"")+">"+h+"</option>"}d.html(c)});var h=[];$.each(e,function(a,b){b=$(b);var c=b.data("type"),d=b.data("typeKey"),e=parseInt(b.val()),f=parseInt(b.data("rate")),g=parseInt(b.data("rateKey"));h.push({type:c,typeKey:d,rateKey:g,qty:e,rate:f})});var i=$(".session-rate-total"),j=$(".tour-topay-total"),k=$("#step3-trip-detail"),l=$("#booking-promo-code").val();$.post({url:a.actionUrl,data:{action:"update-booking-session",payload:h},success:function(a){i.text("$"+a.total.toFixed(2)),j.text("$"+a.totalToPay.toFixed(2)),k.html(a.tripDetails),$(".step3-tour-sub-total").text("$"+a.total.toFixed(2)),$(".step3-tour-topay-total").text("$"+a.totalToPay.toFixed(2)),""!=l&&$("#apply-promo-code").trigger("click")},dataType:"JSON"})})},a.Booking.prototype.confirmBooking=function(){var a=this,b=this.options;$(b.bookingFormElm).on("click",b.btnConfirmBooking,function(c){if(c.preventDefault(),!$("#is_booking_confirmed").is(":checked"))return a.showFlashMsg(".msg-step3","Please accept terms and conditions.","danger"),!1;var d=$(b.bookingFormElm).find("select,input,textarea").serialize();$.post(b.actionUrl,"action=make-booking&"+d,function(a){if(a.isValid){var c=_.template($("#tour-payment-tmpl").html()),d=c(a);$(".step4-content").html(d),$(b.bookingFormElm).steps("next"),$(b.bookingFormElm).find("li.done").addClass("blocked"),$(b.bookingFormElm).find("li.done a").attr("disabled","true")}},"json")})},a.Booking.prototype.setItinerary=function(){var a=this,b=this.options;$(b.tourItineraryElm).on("click",b.btnBookNowStep2,function(c){var d=$("#booking-first-name"),e=$("#booking-last-name"),f=$("#booking-email"),g=$("#booking-phone"),h=!0,i=$(".pax-selector"),j=!1;if($.each(i,function(a,b){b=$(b),0!=b.val()&&(j=!0)}),!j)return a.showFlashMsg(".msg-step2","Please select quantity for activities.","danger"),!1;if(d.val()?d.removeClass("required"):(d.addClass("required"),h=!1),e.val()?e.removeClass("required"):(e.addClass("required"),h=!1),f.val()){if(!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(f.val()))return a.showFlashMsg(".msg-step2","Please provide valid email.","danger"),f.addClass("required"),!1;f.removeClass("required")}else f.addClass("required"),h=!1;if(g.val()){if(!/\(?([0-9]{3})\)?([ .-]?)([0-9]{3})\2([0-9]{4})/.test(g.val()))return a.showFlashMsg(".msg-step2","Please provide valid phone.","danger"),g.addClass("required"),!1;g.removeClass("required")}else g.addClass("required"),h=!1;h?($(".step3-fname").text(d.val()),$(".step3-lname").text(e.val()),$(".step3-email").text(f.val()),$(".step3-phone").text(g.val()),$(".step3-comment").text($("#booking-message").val()),$(b.bookingFormElm).steps("next")):a.showFlashMsg(".msg-step2","Please provide details for required fields.","danger")})},a.Booking.prototype.applyPromoCode=function(){var a=this,b=this.options;$(b.tourItineraryElm).on("click","#apply-promo-code",function(c){c.preventDefault();var d=$(b.bookingFormElm).data("token"),e=$("#booking-promo-code").val();e?$.post({url:b.actionUrl,data:{action:"apply-promo-code",tour:d,code:e},success:function(b){if(b.isValid)if(b.applicable&&b.discountAmount>0){var c=$(".session-rate-total"),d=$(".tour-topay-total"),e=$("#tour-topay-total"),f=b.discountAmount;c.text("$"+b.total.toFixed(2)),d.text("$"+b.totalToPay.toFixed(2)),e.val(b.totalToPay),f=parseFloat(f).toFixed(2),$(".tour-discount-label").text("-$"+f),$(".tour-discount").removeClass("disabled"),$(".step3-tour-discount").text("-$"+f)}else $(".tour-discount-label").text("$0.00"),$(".tour-discount").addClass("disabled"),$(".step3-tour-discount").text("$0.00"),a.showFlashMsg(".msg-promo-code","Promo code is not applicable.","danger");else a.showFlashMsg(".msg-promo-code","Invalid promo code provided.","danger");$(".step3-tour-sub-total").text("$"+b.total.toFixed(2)),$(".step3-tour-topay-total").text("$"+b.totalToPay.toFixed(2))},dataType:"JSON"}):a.showFlashMsg(".msg-promo-code","Please provide promo code.","danger")})},a.Booking.prototype.initBookingCalendar=function(){var a=this,b=this.options;$(b.bookingCalendarElm).datepicker({onSelect:function(){a.getTourSessions()}})},a.Booking.prototype.initFormWizard=function(){var a=this.options,b=$(a.bookingFormElm);b.steps({headerTag:"h4",titleTemplate:"#title#",stepsContainerTag:"nav",bodyTag:"div",transitionEffect:"slideLeft",autoFocus:!0,enablePagination:!1,labels:{current:"",pagination:"Pagination",finish:"Submit",next:"Next",previous:"Previous",loading:"Loading ..."}})},a.Booking.prototype.showFlashMsg=function(a,b,c){var d=this;d.options;b&&c&&($(a).text("").removeAttr("class").addClass(a.substr(1)).show().addClass("msg text-"+c).text(b),setTimeout(function(){$(a).fadeOut()},4500))}}(window,document),function(a){function b(){var a=$(".cover-video"),b=a.data("id");if(1==a.length&&b){var c=document.createElement("script");c.src="https://www.youtube.com/iframe_api?callback=onYouTubeIframeAPIReady",$("head").append(c)}}a.App=function(){this.config={serviceUrl:"/requests/service",loadedGalleries:{}}},a.App.prototype.init=function(){this.config=$.extend(!0,this.config,jsVars),this.toggleNav(".nav-toggle"),this.toggleSubNav(".toggle-sub-nav"),this.initHeroSlider("#slider"),this.initHeroScroll(".hero__scroll"),this.initReviewsCarousel(".reviews-carousel"),this.initFeaturedCarousel(".featured-carousel"),this.initGalleryCarousel(".gallery__carousel"),this.initPhotoswipe(".gallery__carousel a"),this.initShuffle("#shuffle"),this.initGallery("[data-launch-gallery]"),this.initVideoPopup("[data-toggle-popup]"),this.initMap(),this.initNewsletterSignup("#news-signup-form"),this.matchElmHeight(".tour-item"),$(window).on("resize",function(){app.matchElmHeight(".tour-item"),app.setHeroVideoDimensions()}).trigger("resize"),$(".scroll-trigger").on("click",function(a){a.preventDefault();var b=$(window).height();scrollPoint=$(window).scrollTop(),scrollPoint<b&&$("html, body").delay(200).animate({scrollTop:b},{duration:350})}),$(window).on("scroll",function(){if($(window).width()<1200){$(window).scrollTop()>50?$(".logo").addClass("scroll"):$(".logo").removeClass("scroll")}});var a=jsVars.instagramSettings;new Instagram(a).init(),(new Booking).init()},a.App.prototype.setHeroVideoDimensions=function(){var a=$(".video__wrapper iframe");if(a.length){var b=$(window).height(),c=$(window).width(),d=1.77*b;d<c?(d=c,newIframeHeight=.565*c):newIframeHeight=b;a.css({height:newIframeHeight,width:d})}},a.App.prototype.initHeroSlider=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:600,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3,fade:!0,cssEase:"linear",arrows:!0,prevArrow:'<div class="slider__nav slider__nav--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="slider__nav slider__nav--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1})},a.App.prototype.initReviewsCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:600,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:6e3,fade:!0,cssEase:"linear",arrows:!0,prevArrow:'<div class="review__carousel__nav review__carousel__nav--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="review__carousel__nav review__carousel__nav--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1})},a.App.prototype.initFeaturedCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!1,speed:300,slidesToShow:3,slidesToScroll:3,cssEase:"linear",arrows:!0,prevArrow:'<div class="featured__carousel__nav featured__carousel__nav--prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="featured__carousel__nav featured__carousel__nav--next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1,responsive:[{breakpoint:320,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:3}}]})},a.App.prototype.initHeroScroll=function(a){$(a).on("click",function(a){a.preventDefault(),topHeight=$(window).width()<=991?50:220,$("html, body").delay(100).animate({scrollTop:$("#main").offset().top-topHeight},400)})},a.App.prototype.initMap=function(){if($("#map-canvas").length){var a=app.getConfigItem("latitude"),b=app.getConfigItem("longitude"),c=app.getConfigItem("zoomLevel"),d=app.getConfigItem("address");if(a&&b){var e,f=$(window).width(),g=!1,h="/graphics/map-marker.png";f>992&&(g=!0);var i={zoom:parseInt(c),center:new google.maps.LatLng(a,b),scrollwheel:!1,zoomControl:!0,draggable:g,mapTypeId:google.maps.MapTypeId.ROAD};e=new google.maps.Map(document.getElementById("map-canvas"),i),marker=new google.maps.Marker({position:new google.maps.LatLng(a,b),map:e,icon:h});var j=new google.maps.InfoWindow({content:d});marker.addListener("click",function(){j.open(e,marker)})}}},a.App.prototype.initGalleryCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:300,slidesToShow:3,slidesToScroll:1,prevArrow:'<div class="gallery__carousel__prev"><i class="fa fa-angle-left"></i></div>',nextArrow:'<div class="gallery__carousel__next"><i class="fa fa-angle-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1,responsive:[{breakpoint:320,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:3,slidesToScroll:1}}]})},a.App.prototype.initPhotoswipe=function(a){var b=$(a);if(b.length){var c=app.getConfigItem("galleryImages"),d={index:0,shareEl:!1,preload:[1,2],history:!1,bgOpacity:.8};$.each(c,function(a,b){c[a].src=b.full_path}),b.on("click",function(a){a.preventDefault(),d.index=$(this).data("key"),new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,c,d).init()})}},a.App.prototype.initShuffle=function(a){var b=$(a),c=this;b.length&&(b.shuffle({group:"all",itemSelector:"figure",speed:450}),$(".shuffle-trigger").on("click",function(a){a.preventDefault(),b.shuffle("shuffle",$(this).attr("data-group")),$(".shuffle-trigger").removeClass("active"),$(this).addClass("active")}),b.on("done.shuffle",function(){c.initPhotoswipeShuffle(a+" .gallery__item.ps-item")}))},a.App.prototype.initPhotoswipeShuffle=function(a){var b=$(a);if(b.length){var c=app.getConfigItem("templates").psGallery;0==$(".pswp").length&&$("body").append(c);var d={index:0,shareEl:!1,preload:[1,2],history:!1,bgOpacity:.8};b.on("click",function(b){b.preventDefault();var c=$(this),e=(c.data("gp"),$(a).siblings(".filtered")),f=c.data("fpath"),g=[];if(e.length&&e.each(function(a,b){var c=$(b),d=c.attr("data-fpath"),e=c.attr("title"),f=c.data("size").split("x");g.push({src:d,w:f[0],h:f[1],title:e})}),g.length){var h=$.map(g,function(a,b){return a.src});d.index=h.indexOf(f);new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,g,d).init()}})}},a.App.prototype.initGallery=function(a){function b(a,b,c){if(!a)return!1;app.config.loadedGalleries.hasOwnProperty(a)?"function"==typeof c&&c.call():$.get(app.getConfigItem("serviceUrl"),"action=fetch-gallery&key="+a,function(b){app.config.loadedGalleries[a]=b,"function"==typeof c&&c.call()},"json")}function c(a,b){if(!a)return!1;var c=app.config.loadedGalleries[a];if(c.length>0){b&&(e.index=b);new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,c,e).init()}}var d=app.getConfigItem("templates").galleryModal;0==$(".pswp").length&&$("body").append(d);var e={index:0,shareEl:!1,preload:[1,3],history:!1,bgOpacity:.9};$("body").on("click",a,function(a){a.preventDefault();var d=$(this),e=d.data("launch-gallery"),f=d.data("index");d.hasClass("launch-gallery")&&b(e,f,function(){c(e,f)})})},a.App.prototype.initVideoPopup=function(a){var b=$(a);b.length&&(b.on("click",function(a){a.preventDefault();var b=$(this),c=$(b.data("toggle-popup"));c.toggleClass("open"),$("body").addClass("no-scroll");var d=c.find("iframe");d.length&&d.attr("src",d.data("src"))}),$("body").on("click",".popup .close",function(a){a.preventDefault();var b=$(this),c=$(b.attr("href"));c.toggleClass("open"),$("body").removeClass("no-scroll");var d=c.find("iframe");d.length&&d.removeAttr("src")}))},a.App.prototype.getVar=function(a,b){if(b.hasOwnProperty(a))return b[a];for(var c in b)if(b[c].hasOwnProperty(a))return b[c][a];return!1},a.App.prototype.getConfigItem=function(a){return this.getVar(a,this.config)},a.App.prototype.toggleNav=function(a){var b=$(a);b.length&&b.on("click",function(a){a.preventDefault();var b=($(this),$("header nav"));b.length&&(b.toggle(),$(".nav-toggle").toggleClass("active"),$("body").toggleClass("no-scroll"))})},a.App.prototype.toggleSubNav=function(a){var b=$(a);b.length&&b.on("click",function(a){a.preventDefault();var b=$(this),c=b.parents(".has-sub").find("ul");c.length&&(c.toggleClass("active"),b.toggleClass("active"))})},a.App.prototype.matchElmHeight=function(a){var b="string"==typeof a?$(a):a;if(b){b.css("height","auto");var c=0;b.each(function(a,b){var d=$(b),e=d.height();e>c&&(c=e)}),b.css("height",c)}},a.App.prototype.initNewsletterSignup=function(a){var b=$(a);if(b.length){var c=b.find("#newsletter-submit");c.length&&c.on("click",function(a){a.preventDefault();var c=$.trim(b.find("#signup-email").val()),d="",e="msg--error",f=b.find(".msg");if(c){/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(c)?$.post(app.getConfigItem("serviceUrl"),"action=sign-up&email="+c,function(a){return a.msg&&f.removeAttr("class").addClass("msg "+a.type).html(a.msg),a.isValid&&setTimeout(function(){f.removeClass(a.type).html(""),b.find("#full-name").val(""),b.find("#signup-email").val("")},5e3),!1},"json"):d="Invalid email address provided."}else d="Your email address is required.";d&&f.removeAttr("class").addClass("msg "+e).html(d)})}},a.onYouTubeIframeAPIReady=function(){var a,b,c=$(".cover-video").get(0),d=$(".video__wrapper"),e=c.getAttribute("data-id"),f=d.width(),g=d.height();console.log(e),d.css("overflow","hidden");new YT.Player(c,{videoId:e,width:f,height:g,playerVars:{start:0,autoplay:!0,controls:!1,rel:!1,showinfo:!1,modestbranding:!0,loop:!0,fs:!1,cc_load_policy:!0,iv_load_policy:3,autohide:!1,playlist:e},events:{onReady:function(c){c.target.mute(),a=1.77*g,a<f?(a=f,b=.565*f):b=g,$(".cover-video").css({height:b,width:a}),$(".page__photo__caption--ghost").delay(2e3).animate({opacity:"1"},1500).delay(7500).animate({opacity:"0"},1500)}}})},b(),new WOW({animateClass:"animated",offset:100,mobile:!1,callback:function(a){}}).init()}(window);var app=new App;